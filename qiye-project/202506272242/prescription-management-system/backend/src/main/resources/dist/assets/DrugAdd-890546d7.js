import{I as y,a as U}from"./ImageViewer-c64b6ba2.js";import{_ as x,r as c,a as w,d as m,e as p,f as _,g as a,w as l,m as N,E as u,k as h,n as D,j as k,q as E}from"./index-beb53cfa.js";/* empty css                                                                    */const F={components:{ImageUploader:y,ImageViewer:U},setup(){const s=c({drugName:"",specification:"",manufacturer:"",indications:""}),e=c([]),i=w();return{drug:s,drugImages:e,submitForm:async()=>{try{const r=new FormData;r.append("drug",JSON.stringify(s.value)),e.value.forEach((t,g)=>{r.append("images",t)}),console.log("提交图片",e.value);const d=await N.addDrugWithImages(r);if(d.data&&d.data.success){u.success(d.data.msg||"新增药品成功");const t=d.data.drugId||d.data.id;t&&i.push({name:"DrugDetail",params:{id:t}})}else u.error(d.data.msg||"新增药品失败")}catch{u.error("新增药品失败")}},handleImageUpload:r=>{e.value=r}}}},A={class:"drug-add"},B={key:0,style:{"margin-top":"16px"}};function C(s,e,i,o,f,r){const d=m("el-input"),t=m("el-form-item"),g=m("ImageUploader"),V=m("el-button"),I=m("el-form"),b=m("ImageViewer"),v=m("el-card");return p(),_("div",A,[a(v,{class:"form-card"},{default:l(()=>[e[5]||(e[5]=h("h2",{style:{"margin-bottom":"24px"}},"新增药品",-1)),a(I,{onSubmit:D(o.submitForm,["prevent"]),"label-width":"100px",model:o.drug},{default:l(()=>[a(t,{label:"药品名称",required:""},{default:l(()=>[a(d,{modelValue:o.drug.drugName,"onUpdate:modelValue":e[0]||(e[0]=n=>o.drug.drugName=n),placeholder:"请输入药品名称"},null,8,["modelValue"])]),_:1}),a(t,{label:"规格"},{default:l(()=>[a(d,{modelValue:o.drug.specification,"onUpdate:modelValue":e[1]||(e[1]=n=>o.drug.specification=n),placeholder:"如 20mg/片"},null,8,["modelValue"])]),_:1}),a(t,{label:"生产厂家"},{default:l(()=>[a(d,{modelValue:o.drug.manufacturer,"onUpdate:modelValue":e[2]||(e[2]=n=>o.drug.manufacturer=n),placeholder:"请输入生产厂家"},null,8,["modelValue"])]),_:1}),a(t,{label:"适应症"},{default:l(()=>[a(d,{type:"textarea",modelValue:o.drug.indications,"onUpdate:modelValue":e[3]||(e[3]=n=>o.drug.indications=n),placeholder:"请输入适应症"},null,8,["modelValue"])]),_:1}),a(t,{label:"药品图片"},{default:l(()=>[a(g,{onUpload:o.handleImageUpload},null,8,["onUpload"])]),_:1}),a(t,null,{default:l(()=>[a(V,{type:"primary","native-type":"submit"},{default:l(()=>e[4]||(e[4]=[k("新增药品")])),_:1,__:[4]})]),_:1})]),_:1},8,["onSubmit","model"]),o.drugImages.length?(p(),_("div",B,[a(b,{images:o.drugImages},null,8,["images"])])):E("",!0)]),_:1,__:[5]})])}const j=x(F,[["render",C],["__scopeId","data-v-199dd369"]]);export{j as default};
